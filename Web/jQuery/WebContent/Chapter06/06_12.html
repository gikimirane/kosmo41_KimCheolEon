<!DOCTYPE html>
<html>
<head>

</head>
<body>
<script>
    // 06_10_함수 예외처리+함수추가+추가(모든브라우저동작)+구형 브라우저

    // XMLHttpRequest 객체 생성 함수
    function createRequest(){
        
        try{
            return new XMLHttpRequest();
        }catch(exception){
            var versions = [
                'Msxml2.XMLHTTP.6.0',
                'Msxml2.XMLHTTP.5.0',
                'Msxml2.XMLHTTP.4.0',
                'Msxml2.XMLHTTP.3.0',
                'Msxml2.XMLHTTP',
                'Microsoft.XMLHTTP'
            ];
            for(var i = 0; i<versions.length; i++){
                try{
                    return new ActiveXObject(versions[i]);
                }catch(e){

                }
            }
            
        }
        return request;
    }

    // 06_12_비동기방식 request

    // XMLHttpRequest 객체 생성
    var request = createRequest();
    request.onreadystatechange = function(event){
        alert(request.readyState);
        // readyState
        // 0 - request 객체를 만들었지만 open() 메서드로 초기화하지 않았음
        // 1 - request 객체 만들고 초기화했으나 send() 메서드 사용되지 않음
        // 2 - send() 메서드 사용했으나 데이터 못받음
        // 3 - 데이터 일부만 받음
        // 4 - 모든 데이터 받음
    }

    // 3번째 매개변수 true 하면 비동기방식으로 실행한다고 함.
    request.open('GET', './data.html', true);
    /////////////////////////////////////////////////////

    // Ajax 수행하기
    request.send();

    // 출력
    document.body.innerHTML += request.responseText;

</script>

</body>
</html>